<ion-header>
  <ion-toolbar color="secondary">
    <ion-buttons slot="start">
      <ion-back-button defaulthref=""> </ion-back-button>
    </ion-buttons>
    <ion-title>Details</ion-title>
    <ion-badge
      slot="end"
      [color]="task.inspectionType =='Environmental Inspection' ? 'environmental' : 'comprehensive'"
      style="margin-right: 1em"
      >{{task.inspectionType}}</ion-badge
    >
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-card>
    <ion-header>
      <ion-item>
        <ion-badge
          *ngIf="task.internalStatus === 'Completed'"
          color="success"
          slot="end"
          >Completed</ion-badge
        >
        <ion-badge
          color="danger"
          *ngIf="task.internalStatus === 'Pending'"
          slot="end"
          >Pending Sync</ion-badge
        >

        <ion-badge
          color="warning"
          *ngIf="task.internalStatus === 'In Progress'"
          slot="end"
          >In Progress</ion-badge
        >
        <ion-badge
          color="medium"
          *ngIf="task.internalStatus === 'New'"
          slot="end"
          >New</ion-badge
        >

        <ion-label>
          <p>
            {{task.scheduleDateTime | date: 'MMM dd, yyyy hh:mm a'}}
          </p></ion-label
        >
      </ion-item>
    </ion-header>
    <ion-card-content>
      <ion-grid>
        <ion-row>
          <ion-col>
            <h1 style="text-align: center"><strong>{{task.id}} </strong></h1>
          </ion-col>
        </ion-row>
        <ion-row class="ion-no-padding">
          <ion-col>
            <h3 style="text-align: center"><strong>{{task.title}} </strong></h3>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col>
            <ion-label>
              <h1 style="text-align: center">{{task.contactName}}</h1>
            </ion-label>
          </ion-col>
        </ion-row>
        <ion-row *ngIf="task.contactPhone">
          <ion-col class="row-center">
            <ion-chip color="primary" (click)="call()" class="ion-text-center">
              <ion-icon name="call" color="primary"></ion-icon>
              <ion-label>{{task.contactPhone}}</ion-label>
            </ion-chip>
          </ion-col>
        </ion-row>
        <ion-row *ngIf="!task.contactPhone">
          <ion-col class="row-center">
            <ion-chip color="medium" class="ion-text-center">
              <ion-icon name="call" color="medium"></ion-icon>
              <ion-label>No phone number available</ion-label>
            </ion-chip>
          </ion-col>
        </ion-row>
        <ion-row *ngIf="task.contactEmail">
          <ion-col class="row-center">
            <ion-chip color="primary" (click)="email()" class="ion-text-center">
              <ion-icon name="mail-outline" color="primary"></ion-icon>
              <ion-label>{{task.contactEmail}}</ion-label>
            </ion-chip>
          </ion-col>
        </ion-row>
        <ion-row *ngIf="!task.contactEmail">
          <ion-col class="row-center">
            <ion-chip color="medium" class="ion-text-center">
              <ion-icon name="mail-outline" color="medium"></ion-icon>
              <ion-label>No email available</ion-label>
            </ion-chip>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col class="row-center">
            <ion-chip
              color="primary"
              (click)="gpsNavigate()"
              class="ion-text-center"
            >
              <ion-icon name="navigate-outline" color="primary"></ion-icon>
              <ion-label>{{task.serviceAddress}}</ion-label>
            </ion-chip>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col>
            <ion-label>
              <h2><strong>Inspection Instructions: </strong></h2>
            </ion-label>
            <div class="ion-text-justify">
              <p>{{task.inspectionsInstructions}}</p>
            </div>
          </ion-col>
        </ion-row>

        <ion-row>
          <ion-col>
            <ion-label>
              <h2><strong>Inspection Types:</strong></h2>
            </ion-label>
            <div
              class="ion-text-justify"
              *ngFor="let item of task.inspectionSubTypes"
            >
              <p>
                <ion-icon name="checkmark-outline" color="success"></ion-icon
                >{{item.name}}
              </p>
            </div>
          </ion-col>
        </ion-row>
      </ion-grid>

      <ion-item-divider></ion-item-divider>
      <ion-label>
        <h2>Referal Partner:</h2>
      </ion-label>

      <ion-item
        *ngIf="task.referalPartnerContact && task.referalPartnerContact.firstName "
      >
        <ion-avatar slot="start">
          <img src="../../../assets/images/avatar.svg" />
        </ion-avatar>
        <ion-label>
          <h3>
            {{task.referalPartnerContact.firstName + " " +
            task.referalPartnerContact.lastName}}
          </h3>

          <h3>
            <ion-chip
              *ngIf="task.referalPartnerContact.contactPhone"
              color="primary"
              (click)="call()"
              class="ion-text-center"
            >
              <ion-icon name="call" color="primary"></ion-icon>
              <ion-label>{{task.referalPartnerContact.contactPhone}}</ion-label>
            </ion-chip>

            <ion-chip
              color="medium"
              class="ion-text-center"
              *ngIf="!task.referalPartnerContact.contactPhone"
            >
              
              <ion-icon name="call" color="medium"></ion-icon>
              <ion-label>No phone number available</ion-label>
            </ion-chip>
          </h3>

          <h3>
            <ion-chip
              *ngIf="task.referalPartnerContact.contactEmail"
              color="primary"
              (click)="email()"
              class="ion-text-center"
            >
              <ion-icon name="mail-outline" color="primary"></ion-icon>
              <ion-label>{{task.referalPartnerContact.contactEmail}}</ion-label>
            </ion-chip>

            <ion-chip
              color="medium"
              class="ion-text-center"
              *ngIf="!task.referalPartnerContact.contactEmail"
            >
              
              <ion-icon name="mail-outline" color="medium"></ion-icon>
              <ion-label>No email available</ion-label>
            </ion-chip>
          </h3>
        </ion-label>
      </ion-item>

      <ion-item
        *ngIf="task.referalPartnerCompany && task.referalPartnerCompany.title"
      >
        <ion-avatar slot="start">
          <img src="../../../assets/images/avatar.svg" />
        </ion-avatar>
        <ion-label>
          <h3>{{task.referalPartnerCompany.title}}</h3>
          <p>{{task.referalPartnerCompany.type}}</p>
        </ion-label>
      </ion-item>
    </ion-card-content>

    <ion-footer>
      <ion-grid
        ><ion-row>
          <ion-col class="row-center">
            <ion-chip
              color="primary"
              (click)="startInspection()"
              *ngIf="task.internalStatus === 'New' || task.internalStatus === 'In Progress' "
            >
              <ion-icon name="create-outline" color="primary"></ion-icon>
              <ion-label>Start Inspection</ion-label>
            </ion-chip></ion-col
          >
          <ion-col class="row-center" *ngIf="task.contactPhone">
            <ion-chip color="success" (click)="call()">
              <ion-icon name="call" color="success"></ion-icon>
              <ion-label>{{task.contactPhone}}</ion-label>
            </ion-chip>
          </ion-col>
        </ion-row></ion-grid
      >
    </ion-footer>
  </ion-card>
</ion-content>
